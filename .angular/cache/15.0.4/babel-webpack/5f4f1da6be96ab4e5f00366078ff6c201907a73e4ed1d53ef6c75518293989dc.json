{"ast":null,"code":"import jwt_decode from 'jwt-decode';\nimport { BehaviorSubject } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"./../token.service\";\nexport class UsuarioService {\n  constructor(tokenService) {\n    this.tokenService = tokenService;\n    this.usuarioSubject = new BehaviorSubject({});\n    if (this.tokenService.possuiToken()) {\n      this.decodificaJWT();\n    }\n  }\n  decodificaJWT() {\n    const token = this.tokenService.retornaToken();\n    const usuario = jwt_decode(token);\n    this.usuarioSubject.next(usuario);\n  }\n  retornaUsuario() {\n    return this.usuarioSubject.asObservable();\n  }\n  salvaToken(token) {\n    this.tokenService.salvaToken(token);\n    this.decodificaJWT();\n  }\n  logout() {\n    this.tokenService.excluiToken();\n    this.usuarioSubject.next({});\n  }\n  estaLogado() {\n    return this.tokenService.possuiToken();\n  }\n}\nUsuarioService.ɵfac = function UsuarioService_Factory(t) {\n  return new (t || UsuarioService)(i0.ɵɵinject(i1.TokenService));\n};\nUsuarioService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: UsuarioService,\n  factory: UsuarioService.ɵfac,\n  providedIn: 'root'\n});","map":{"version":3,"mappings":"AAEA,OAAOA,UAAU,MAAM,YAAY;AAEnC,SAASC,eAAe,QAAQ,MAAM;;;AAKtC,OAAM,MAAOC,cAAc;EAIzBC,YAAoBC,YAA0B;IAA1B,iBAAY,GAAZA,YAAY;IAFxB,mBAAc,GAAG,IAAIH,eAAe,CAAU,EAAE,CAAC;IAGvD,IAAG,IAAI,CAACG,YAAY,CAACC,WAAW,EAAE,EAAC;MACjC,IAAI,CAACC,aAAa,EAAE;;EAEvB;EAEOA,aAAa;IACnB,MAAMC,KAAK,GAAG,IAAI,CAACH,YAAY,CAACI,YAAY,EAAE;IAC9C,MAAMC,OAAO,GAAGT,UAAU,CAACO,KAAK,CAAY;IAC5C,IAAI,CAACG,cAAc,CAACC,IAAI,CAACF,OAAO,CAAC;EACnC;EAEAG,cAAc;IACZ,OAAO,IAAI,CAACF,cAAc,CAACG,YAAY,EAAE;EAC3C;EAEAC,UAAU,CAACP,KAAa;IACtB,IAAI,CAACH,YAAY,CAACU,UAAU,CAACP,KAAK,CAAC;IACnC,IAAI,CAACD,aAAa,EAAE;EACtB;EAEAS,MAAM;IACJ,IAAI,CAACX,YAAY,CAACY,WAAW,EAAE;IAC/B,IAAI,CAACN,cAAc,CAACC,IAAI,CAAC,EAAE,CAAC;EAC9B;EAEAM,UAAU;IACR,OAAO,IAAI,CAACb,YAAY,CAACC,WAAW,EAAE;EACxC;;AAhCWH,cAAc;mBAAdA,cAAc;AAAA;AAAdA,cAAc;SAAdA,cAAc;EAAAgB,SAAdhB,cAAc;EAAAiB,YAFb;AAAM","names":["jwt_decode","BehaviorSubject","UsuarioService","constructor","tokenService","possuiToken","decodificaJWT","token","retornaToken","usuario","usuarioSubject","next","retornaUsuario","asObservable","salvaToken","logout","excluiToken","estaLogado","factory","providedIn"],"sourceRoot":"","sources":["/home/ana/Documentos/okp/gatBook/BookG/src/app/autenticacao/usuario/usuario.service.ts"],"sourcesContent":["import { TokenService } from './../token.service';\nimport { Injectable } from '@angular/core';\nimport jwt_decode from 'jwt-decode';\nimport { Usuario } from './usuario';\nimport { BehaviorSubject } from 'rxjs';\n\n@Injectable({\n  providedIn: 'root'\n})\nexport class UsuarioService {\n\n  private usuarioSubject = new BehaviorSubject<Usuario>({});\n\n  constructor(private tokenService: TokenService) {\n    if(this.tokenService.possuiToken()){\n      this.decodificaJWT();\n    }\n   }\n\n  private decodificaJWT(){\n    const token = this.tokenService.retornaToken();\n    const usuario = jwt_decode(token) as Usuario;\n    this.usuarioSubject.next(usuario);\n  }\n\n  retornaUsuario(){\n    return this.usuarioSubject.asObservable();\n  }\n\n  salvaToken(token: string){\n    this.tokenService.salvaToken(token);\n    this.decodificaJWT();\n  }\n\n  logout(){\n    this.tokenService.excluiToken();\n    this.usuarioSubject.next({});\n  }\n\n  estaLogado() {\n    return this.tokenService.possuiToken();\n  }\n\n\n\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}